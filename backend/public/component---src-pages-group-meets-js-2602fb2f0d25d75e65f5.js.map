{"version":3,"sources":["webpack:///./src/components/groupLayout.js","webpack:///./node_modules/@babel/runtime/helpers/esm/objectWithoutPropertiesLoose.js","webpack:///./src/components/tableForm.js","webpack:///./src/pages/group/meets.js"],"names":["menyItems","urn","name","permName","meetsLisMap","platformAndGroupQuery","id","dateStart","description","key","title","getDate","color","linkAddress","menuLisBuilder","perms","filter","map","className","to","children","query","urlSearchParams","platformId","get","groupId","url","URLS","MEET_FROM_GROUP$ID_GET","replace","useState","authFetch","meets","meet","meetsLis","setMeetsRows","getGroupPerms","menuLis","setMenuRows","useEffect","cb","length","_objectWithoutPropertiesLoose","source","excluded","i","target","sourceKeys","Object","keys","indexOf","TableForm","state","error","rows","data","creatingLis","creationAllowed","onFillListeners","updateNewField","eOrName","value","element","setState","deleteRow","fetchWithStatusProcessing","props","fetchDeleteAddress","deleteIdParameterName","method","headers","Authentication","getToken","then","code","success","console","old","forEach","ref","field","current","info","sendCreationData","fieldsData","setCreatingElements","body","JSON","stringify","staticPostBodyData","enctype","FormData","entries","k","v","log","append","fetchPostAddress","ERRORS","isBrowser","window","location","reload","responsePostDataName","addToTable","itemOrItems","Array","isArray","newRows","obj","fields","objectsFields","processor","x","propName","alt","processorData","entire","push","type","onClick","buttonDelete","objectField","objectFieldName","customInputField","inputFieldsComponents","colSpan","colSpans","onChange","component","React","createRef","getTableData","onTableFillTrigger","Date","now","Math","random","render","titleFields","disabled","buttonAdd","componentDidMount","this","fetchGetAddress","responseGetDataName","Component","DateInput","PlatformGroups","href","MEET_POST","MEET$ID_DELETE","dateTime","rel","dateEnd"],"mappings":"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","file":"component---src-pages-group-meets-js-2602fb2f0d25d75e65f5.js","sourcesContent":["import React, { useEffect, useState } from \"react\"\r\nimport { Link } from \"gatsby\"\r\n\r\nimport { urlSearchParams, getDate } from \"../utils/functions.js\"\r\nimport { AuthorizedContent, authFetch, getGroupPerms } from \"../utils/auth.js\"\r\nimport URLS from \"../utils/urls.js\"\r\n\r\nimport Layout from \"./layout.js\"\r\n\r\nimport FlatTile from \"../models/flatTile.js\"\r\n\r\nconst menyItems = [\r\n  // { urn: `settings`, name: `Ustawienia ogólne`, permName:`isMaster` },\r\n  { urn: `notes`, name: `Oceny`, permName: `isMaster` },\r\n  { urn: `users`, name: `Użytkownicy`, permName: `isMaster` },\r\n  // { urn: `roles`, name: `Role`, permName:`isMaster` },\r\n  { urn: `materials`, name: `Materiały`, permName: `isMaster` },\r\n  { urn: `tasks`, name: `Zadania`, permName: `isMaster` },\r\n  { urn: `meets`, name: `Spotkania`, permName: `isMaster` },\r\n]\r\n\r\nconst meetsLisMap = ({ id, dateStart, description }, platformAndGroupQuery) => (\r\n  <li key={id}>\r\n    <FlatTile\r\n      title={getDate(`YYYY.MM.DD - hh:mm`, dateStart)}\r\n      description={description}\r\n      color={`#3e8bff`}\r\n      linkAddress={`/meet/it?${platformAndGroupQuery}&meetId=${id}`}\r\n    />\r\n  </li>\r\n)\r\nconst menuLisBuilder = (perms, platformAndGroupQuery) =>\r\n  menyItems\r\n    .filter(({ permName }) => !permName || perms[permName])\r\n    .map(({ urn, name }) => (\r\n      <li key={urn} className=\"list-item\">\r\n        <Link to={`/group/${urn}?${platformAndGroupQuery}`}>{name}</Link>\r\n      </li>\r\n    ))\r\n\r\nexport default ({ children, className = `` }) => {\r\n  const query = urlSearchParams()\r\n\r\n  const platformId = query.get(`platformId`)\r\n  const groupId = query.get(`groupId`)\r\n  const platformAndGroupQuery = `platformId=${platformId}&groupId=${groupId}`\r\n  const url = URLS.MEET_FROM_GROUP$ID_GET.replace(`:groupId`, groupId)\r\n\r\n  const [meetsLis, setMeetsRows] = useState(\r\n    (authFetch({ url }) || { meets: [] }).meets.map(meet =>\r\n      meetsLisMap(meet, platformAndGroupQuery)\r\n    )\r\n  )\r\n  const [menuLis, setMenuRows] = useState(\r\n    menuLisBuilder(getGroupPerms(groupId) || {}, platformAndGroupQuery)\r\n  )\r\n\r\n  useEffect(() => {\r\n    authFetch({\r\n      url,\r\n      cb: ({ meets }) =>\r\n        setMeetsRows(\r\n          meets.map(meet => meetsLisMap(meet, platformAndGroupQuery))\r\n        ),\r\n    })\r\n  }, [url, platformAndGroupQuery])\r\n\r\n  useEffect(() => {\r\n    getGroupPerms(groupId, perms => {\r\n      setMenuRows(menuLisBuilder(perms || {}, platformAndGroupQuery))\r\n    })\r\n  }, [groupId, platformAndGroupQuery])\r\n\r\n  return (\r\n    <AuthorizedContent>\r\n      <Layout className=\"main_wrapper-splited\">\r\n        <nav className=\"main_wrapper-splited-left_column\">\r\n          {menuLis.length ? (\r\n            <>\r\n              <h2>Panel ustawień</h2>\r\n              <ul className=\"list\">{menuLis}</ul>\r\n              <hr />\r\n            </>\r\n          ) : null}\r\n\r\n          <h2>Spotkania</h2>\r\n          <ul className=\"list\">\r\n            {meetsLis.length ? meetsLis : \"Nie należysz do żadnego spotkania\"}\r\n          </ul>\r\n        </nav>\r\n\r\n        <article className={`main_wrapper-splited-right_column ${className}`}>\r\n          {children}\r\n        </article>\r\n      </Layout>\r\n    </AuthorizedContent>\r\n  )\r\n}\r\n","export default function _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}","import React from \"react\"\r\nimport PropTypes from \"prop-types\"\r\n\r\nimport { getToken } from \"../utils/auth.js\"\r\nimport ERRORS from \"../utils/errorList.js\"\r\nimport { isBrowser, fetchWithStatusProcessing } from \"../utils/functions.js\"\r\n\r\n// TODO cały komponent do przerobienia\r\nexport default class TableForm extends React.Component {\r\n  state = {\r\n    error: ``,\r\n    rows: [],\r\n    data: [],\r\n    creatingLis: [],\r\n    creationAllowed: true,\r\n  }\r\n\r\n  onFillListeners = []\r\n\r\n  componentDidMount() {\r\n    this.setCreatingElements()\r\n    console.log(1)\r\n\r\n    fetchWithStatusProcessing(this.props.fetchGetAddress, {\r\n      method: `GET`,\r\n      headers: { Authentication: `Bearer ${getToken()}` },\r\n    }).then(data => {\r\n      if (data.error) {\r\n        const { code, error } = data\r\n        return console.error({ code, error })\r\n      }\r\n\r\n      if (data.success) {\r\n        const { code, success } = data\r\n        return console.info({ code, success })\r\n      }\r\n\r\n      console.log(2, data)\r\n      this.addToTable(data[this.props.responseGetDataName])\r\n      this.onFillListeners.forEach(({ ref, field }) => ref.current[field]())\r\n    })\r\n    console.log(3)\r\n  }\r\n\r\n  updateNewField = (eOrName, value=null) => {\r\n    const element = eOrName.target || eOrName\r\n\r\n    this.setState({ [value ? eOrName : element.name]:(value || element.value) })\r\n  }\r\n\r\n  deleteRow = id => {\r\n    fetchWithStatusProcessing(\r\n      this.props.fetchDeleteAddress.replace(\r\n        this.props.deleteIdParameterName,\r\n        id\r\n      ),\r\n      {\r\n        method: `DELETE`,\r\n        headers: { Authentication: `Bearer ${getToken()}` },\r\n      }\r\n    ).then(({ code, error, success }) => {\r\n      if (error) {\r\n        return console.error({ code, error })\r\n      }\r\n\r\n      if (success) {\r\n        this.setState(old => ({\r\n          rows: old.rows.filter(({ key }) => key !== id),\r\n        }))\r\n\r\n        this.onFillListeners.forEach(({ ref, field }) => ref.current[field]())\r\n\r\n        return console.info({ code, success })\r\n      }\r\n    })\r\n  }\r\n\r\n  sendCreationData = () => {\r\n    const {\r\n      error,\r\n      rows,\r\n      data,\r\n      creatingLis,\r\n      creationAllowed,\r\n      ...fieldsData\r\n    } = this.state\r\n\r\n    this.setCreatingElements()\r\n    this.setState({ creationAllowed: false })\r\n\r\n    const headers =  { Authentication: `Bearer ${getToken()}` }\r\n    let body = JSON.stringify({ ...fieldsData, ...this.props.staticPostBodyData })\r\n\r\n    if (this.props.enctype === `multipart/form-data`) {\r\n      body = new FormData()\r\n\r\n      Object.entries({ ...fieldsData, ...this.props.staticPostBodyData }).forEach( ([ k, v ]) => {\r\n        console.log({ k, v })\r\n        body.append( k, v )\r\n      } )\r\n    } else headers[ \"Content-Type\" ] = `application/json`\r\n\r\n    fetchWithStatusProcessing(this.props.fetchPostAddress, {\r\n      method: `POST`,\r\n      headers,\r\n      body,\r\n    }).then(data => {\r\n      this.setState({ creationAllowed: true })\r\n\r\n      if (data.error) {\r\n        const { code, error } = data\r\n\r\n        console.error({ code, error })\r\n\r\n        return this.setState({ error: ERRORS[data.code] })\r\n      }\r\n\r\n      this.setState({ error: `` })\r\n\r\n      if (data.success) {\r\n        //TODO get value from every cell and make new row\r\n        const { code, success } = data\r\n\r\n        console.log({data})\r\n\r\n\r\n        console.info({ code, success })\r\n\r\n        return isBrowser() && window.location.reload()\r\n      }\r\n\r\n      if (this.props.responsePostDataName) {\r\n        this.addToTable(data[this.props.responsePostDataName])\r\n      }\r\n    })\r\n  }\r\n\r\n  /** @param {object[]} itemOrItems */\r\n  addToTable = itemOrItems => {\r\n    if (!Array.isArray(itemOrItems)) itemOrItems = [itemOrItems]\r\n\r\n    const newRows = itemOrItems.map(obj => {\r\n      const fields = []\r\n\r\n      for (const field of this.props.objectsFields) {\r\n        if (typeof field === `object`) {\r\n          const processor = field.processor || (x => x)\r\n          const propName = field.alt || field.name\r\n          const processorData = field.entire ? obj : obj[ propName ]\r\n\r\n          fields.push(\r\n            <td key={field.name}>{processor( processorData )}</td>\r\n          )\r\n        } else fields.push(<td key={field}>{obj[field]}</td>)\r\n      }\r\n\r\n      return (\r\n        <tr key={obj.id}>\r\n          {fields}\r\n\r\n          <td>\r\n            <button type=\"button\" onClick={() => this.deleteRow(obj.id)}>\r\n              {this.props.buttonDelete}\r\n            </button>\r\n          </td>\r\n        </tr>\r\n      )\r\n    })\r\n\r\n    this.setState(old => ({\r\n      rows: [...newRows, ...old.rows],\r\n      data: [...itemOrItems, ...old.data],\r\n    }))\r\n  }\r\n\r\n  setCreatingElements = () => {\r\n    const creatingLis = []\r\n\r\n    for (let i = 0; i < this.props.objectsFields.length; ++i) {\r\n      const objectField = this.props.objectsFields[i]\r\n      const objectFieldName = objectField.name || objectField\r\n\r\n      const customInputField = this.props.inputFieldsComponents?.[\r\n        objectFieldName\r\n      ]\r\n      const colSpan = this.props.colSpans?.[objectFieldName]\r\n\r\n      let element = (\r\n        <input onChange={this.updateNewField} name={objectFieldName} />\r\n      )\r\n\r\n      if (colSpan) i += colSpan - 1\r\n      if (customInputField) {\r\n        if (!(`props` in customInputField)) customInputField.props = {}\r\n        if (typeof customInputField.component == `string`) {\r\n          element = (\r\n            <customInputField.component\r\n              name={objectFieldName}\r\n              {...customInputField.props}\r\n              onChange={this.updateNewField}\r\n            />\r\n          )\r\n        } else {\r\n          const ref = React.createRef()\r\n\r\n          element = (\r\n            <customInputField.component\r\n              name={objectFieldName}\r\n              {...customInputField.props}\r\n              onChange={this.updateNewField}\r\n              getTableData={() => this.state.data}\r\n              ref={ref}\r\n            />\r\n          )\r\n\r\n          if (customInputField.onTableFillTrigger) {\r\n            this.onFillListeners.push({\r\n              ref,\r\n              field: customInputField.onTableFillTrigger,\r\n            })\r\n          }\r\n        }\r\n      }\r\n\r\n      creatingLis.push(\r\n        <td\r\n          key={`${Date.now()}.${Math.random()}`}\r\n          colSpan={colSpan}\r\n          className=\"inputCell\"\r\n        >\r\n          {element}\r\n        </td>\r\n      )\r\n    }\r\n\r\n    this.setState({ creatingLis })\r\n  }\r\n\r\n  render = () => (\r\n    <table className=\"table\">\r\n      {console.log(4)}\r\n      <thead className=\"thead\">\r\n        <tr>\r\n          {this.props.titleFields.map(field => (\r\n            <td key={field}>{field}</td>\r\n          ))}\r\n\r\n          <td>Akcja</td>\r\n        </tr>\r\n      </thead>\r\n\r\n      <tbody>\r\n        <tr>\r\n          {this.state.creatingLis}\r\n          {console.log(5)}\r\n          <td>\r\n            <button\r\n              type=\"button\"\r\n              onClick={this.sendCreationData}\r\n              disabled={!this.state.creationAllowed}\r\n            >\r\n              {this.props.buttonAdd}\r\n            </button>\r\n          </td>\r\n        </tr>\r\n\r\n        <tr className=\"emptyRow\">\r\n          <td colSpan=\"5\">{this.state.error}</td>\r\n        </tr>\r\n        <tr className=\"emptyRow\" />\r\n\r\n        {this.state.rows}\r\n      </tbody>\r\n    </table>\r\n  )\r\n}\r\n\r\nTableForm.propTypes = {\r\n  fetchGetAddress: PropTypes.string.isRequired,\r\n  fetchDeleteAddress: PropTypes.string.isRequired,\r\n  fetchPostAddress: PropTypes.string.isRequired,\r\n\r\n  deleteIdParameterName: PropTypes.string.isRequired,\r\n  responseGetDataName: PropTypes.string.isRequired,\r\n  responsePostDataName: PropTypes.string,\r\n  staticPostBodyData: PropTypes.objectOf(PropTypes.string).isRequired,\r\n\r\n  buttonAdd: PropTypes.string.isRequired,\r\n  buttonDelete: PropTypes.string.isRequired,\r\n\r\n  objectsFields: PropTypes.array.isRequired,\r\n  titleFields: PropTypes.array.isRequired,\r\n  inputFieldsComponents: PropTypes.object,\r\n  colSpans: PropTypes.object,\r\n}\r\n","import React from \"react\"\r\nimport { Link } from \"gatsby\"\r\n\r\nimport { urlSearchParams, getDate } from \"../../utils/functions.js\"\r\nimport URLS from \"../../utils/urls.js\"\r\n\r\nimport Layout from \"../../components/groupLayout.js\"\r\nimport TableForm from \"../../components/tableForm.js\"\r\n\r\nconst DateInput = props => <input type=\"datetime-local\" {...props} />\r\n\r\nexport default class PlatformGroups extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n\r\n    const query = urlSearchParams()\r\n\r\n    this.groupId = query.get(`groupId`)\r\n    this.platformId = query.get(`platformId`)\r\n\r\n    this.href = `/group/it?platformId=${this.platformId}&groupId=${this.groupId}`\r\n  }\r\n\r\n  render = () => (\r\n    <Layout className=\"is-centered\">\r\n      <Link className=\"return_link\" to={this.href}>\r\n        Powrót do widoku grupy\r\n      </Link>\r\n\r\n      <h1>Grupa -- spotkania</h1>\r\n      <p>\r\n        <strong>Ważne!</strong> Lista spotkań po lewej stronie zaktualizuje się\r\n        dopiero po odświeżeniu strony\r\n      </p>\r\n\r\n      <TableForm\r\n        fetchPostAddress={URLS.MEET_POST}\r\n        fetchGetAddress={URLS.MEET_FROM_GROUP$ID_GET.replace(\r\n          `:groupId`,\r\n          this.groupId\r\n        ).replace(`:platformId`, this.platformId)}\r\n        fetchDeleteAddress={URLS.MEET$ID_DELETE}\r\n        deleteIdParameterName=\":meetId\"\r\n        responseGetDataName=\"meets\"\r\n        responsePostDataName=\"meet\"\r\n        buttonAdd=\"Dodaj do grupy\"\r\n        buttonDelete=\"Usuń z grupy\"\r\n        staticPostBodyData={{\r\n          groupId: this.groupId,\r\n          platformId: this.platformId,\r\n        }}\r\n        objectsFields={[\r\n          {\r\n            name: `dateStart`,\r\n            processor: dateTime => getDate(`YYYY:MM:DD hh:mm`, dateTime),\r\n          },\r\n          {\r\n            name: `dateEnd`,\r\n            processor: dateTime => getDate(`YYYY:MM:DD hh:mm`, dateTime),\r\n          },\r\n          `description`,\r\n          {\r\n            name: `externalUrl`,\r\n            processor: url => <a href={url} target=\"_blank\" rel=\"noreferrer\">Link do spotkania</a>,\r\n          },\r\n        ]}\r\n        titleFields={[\r\n          `Data rozpoczęcia`,\r\n          `Data zakończenia`,\r\n          `Opis`,\r\n          `Link do spotkania`,\r\n        ]}\r\n        inputFieldsComponents={{\r\n          dateStart: { component: DateInput },\r\n          dateEnd: { component: DateInput },\r\n        }}\r\n      />\r\n    </Layout>\r\n  )\r\n}\r\n"],"sourceRoot":""}
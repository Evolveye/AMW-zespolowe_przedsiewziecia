{"version":3,"sources":["webpack:///./src/pages/platform/roles.js","webpack:///./src/components/platformLayout.js"],"names":["platformId","urlSearchParams","get","className","to","navItems","urn","name","permName","groupsLisMap","id","key","title","color","linkAddress","menuLisBuilder","perms","filter","map","children","url","URLS","GROUP_FROM_PLATFORM$ID_GET","replace","useState","authFetch","groups","group","groupsLis","setGroupsRows","getPlatformPerms","menuLis","setMenuRows","useEffect","cb","length"],"mappings":"4FAAA,oEASe,qBACb,IAAMA,EAAaC,cAAkBC,IAAlB,cAEnB,OACE,kBAAC,IAAD,CAAQC,UAAU,wBAChB,kBAAC,OAAD,CACEA,UAAU,cACVC,GAAE,2BAA6BJ,GAFjC,8BAOA,oDACA,wC,kCCtBN,iGAeMK,EAAW,CACf,CAAEC,IAAI,WAAaC,KAAK,SAAWC,SAAS,YAC5C,CAAEF,IAAI,QAAUC,KAAK,cAAgBC,SAAS,YAE9C,CAAEF,IAAI,SAAWC,KAAK,QAAUC,SAAS,aAGrCC,EAAe,SAAC,EAAcT,GAAf,IAAGU,EAAH,EAAGA,GAAIH,EAAP,EAAOA,KAAP,OACnB,wBAAII,IAAKD,GACP,kBAAC,IAAD,CACEE,MAAOL,EACPM,MAAK,UACLC,YAAW,wBAA0Bd,EAA1B,YAAgDU,MAK3DK,EAAiB,SAACC,EAAOhB,GAAR,OACrBK,EACGY,QAAO,gBAAGT,EAAH,EAAGA,SAAH,OAAmBA,GAAYQ,EAAMR,MAC5CU,KAAI,gBAAGZ,EAAH,EAAGA,IAAKC,EAAR,EAAQA,KAAR,OACH,wBAAII,IAAKL,EAAKH,UAAU,aACtB,kBAAC,OAAD,CAAMC,GAAE,aAAeE,EAAf,eAAiCN,GAAeO,QAIjD,gBAAmC,IAAhCY,EAA+B,EAA/BA,SAA+B,IAArBhB,iBAAqB,WAEzCH,EADQC,cACWC,IAAN,cACbkB,EAAMC,IAAKC,2BAA2BC,QAAhC,cAAuDvB,GAHpB,EAKZwB,oBAChCC,YAAU,CAAEL,SAAU,CAAEM,OAAQ,KAAMA,OAAOR,KAAI,SAAAS,GAAK,OACrDlB,EAAakB,EAAO3B,OAFjB4B,EALwC,KAK7BC,EAL6B,OAUhBL,mBAC7BT,EAAee,YAAiB9B,IAAe,GAAIA,IAD9C+B,EAVwC,KAU/BC,EAV+B,KA4B/C,OAdAC,qBAAU,WACRR,YAAU,CACRL,MACAc,GAAI,gBAAGR,EAAH,EAAGA,OAAH,OACFG,EAAcH,EAAOR,KAAI,SAAAS,GAAK,OAAIlB,EAAakB,EAAO3B,YAEzD,CAACoB,EAAKpB,IAETiC,qBAAU,WACRH,YAAiB9B,GAAY,SAAAgB,GAC3BgB,EAAYjB,EAAeC,GAAS,GAAIhB,SAEzC,CAACA,IAGF,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQG,UAAU,wBAChB,yBAAKA,UAAU,oCACZ4B,EAAQI,OACP,oCACE,8CACA,wBAAIhC,UAAU,QAAQ4B,GACtB,8BAEA,KAEJ,qCACA,wBAAI5B,UAAU,QACXyB,EAAUO,OAASP,EAAY,iCAIpC,6BAASzB,UAAS,qCAAuCA,GACtDgB","file":"component---src-pages-platform-roles-js-bfc2bb7f49465cb67942.js","sourcesContent":["import React from \"react\"\r\nimport { Link } from \"gatsby\"\r\n\r\nimport { urlSearchParams } from \"../../utils/functions.js\"\r\n\r\nimport Layout from \"../../components/platformLayout.js\"\r\n\r\n// import classes from \"./platform.module.css\"\r\n\r\nexport default () => {\r\n  const platformId = urlSearchParams().get(`platformId`)\r\n\r\n  return (\r\n    <Layout className=\"main_wrapper-splited\">\r\n      <Link\r\n        className=\"return_link\"\r\n        to={`/platform/it?platformId=${platformId}`}\r\n      >\r\n        Powrót do widoku platformy\r\n      </Link>\r\n\r\n      <h1>Platforma edukacyjna</h1>\r\n      <div>Role</div>\r\n    </Layout>\r\n  )\r\n}\r\n","import React, { useEffect, useState } from \"react\"\r\nimport { Link } from \"gatsby\"\r\n\r\nimport URLS from \"../utils/urls.js\"\r\nimport { urlSearchParams } from \"../utils/functions.js\"\r\nimport {\r\n  AuthorizedContent,\r\n  getPlatformPerms,\r\n  authFetch,\r\n} from \"../utils/auth.js\"\r\n\r\nimport Layout from \"./layout.js\"\r\n\r\nimport FlatTile from \"../models/flatTile.js\"\r\n\r\nconst navItems = [\r\n  { urn: `settings`, name: `Ogólne`, permName: `isMaster` },\r\n  { urn: `users`, name: `Użytkownicy`, permName: `isMaster` },\r\n  // { urn: `roles`, name: `Role`, permName: `isMaster` },\r\n  { urn: `groups`, name: `Grupy`, permName: `isMaster` },\r\n]\r\n\r\nconst groupsLisMap = ({ id, name }, platformId) => (\r\n  <li key={id}>\r\n    <FlatTile\r\n      title={name}\r\n      color={`#3e8bff`}\r\n      linkAddress={`/group/it?platformId=${platformId}&groupId=${id}`}\r\n    />\r\n  </li>\r\n)\r\n\r\nconst menuLisBuilder = (perms, platformId) =>\r\n  navItems\r\n    .filter(({ permName }) => !permName || perms[permName])\r\n    .map(({ urn, name }) => (\r\n      <li key={urn} className=\"list-item\">\r\n        <Link to={`/platform/${urn}?platformId=${platformId}`}>{name}</Link>\r\n      </li>\r\n    ))\r\n\r\nexport default ({ children, className = `` }) => {\r\n  const query = urlSearchParams()\r\n  const platformId = query.get(`platformId`)\r\n  const url = URLS.GROUP_FROM_PLATFORM$ID_GET.replace(`:platformId`, platformId)\r\n\r\n  const [groupsLis, setGroupsRows] = useState(\r\n    (authFetch({ url }) || { groups: [] }).groups.map(group =>\r\n      groupsLisMap(group, platformId)\r\n    )\r\n  )\r\n  const [menuLis, setMenuRows] = useState(\r\n    menuLisBuilder(getPlatformPerms(platformId) || {}, platformId)\r\n  )\r\n\r\n  useEffect(() => {\r\n    authFetch({\r\n      url,\r\n      cb: ({ groups }) =>\r\n        setGroupsRows(groups.map(group => groupsLisMap(group, platformId))),\r\n    })\r\n  }, [url, platformId])\r\n\r\n  useEffect(() => {\r\n    getPlatformPerms(platformId, perms => {\r\n      setMenuRows(menuLisBuilder(perms || {}, platformId))\r\n    })\r\n  }, [platformId])\r\n\r\n  return (\r\n    <AuthorizedContent>\r\n      <Layout className=\"main_wrapper-splited\">\r\n        <nav className=\"main_wrapper-splited-left_column\">\r\n          {menuLis.length ? (\r\n            <>\r\n              <h2>Panel ustawień</h2>\r\n              <ul className=\"list\">{menuLis}</ul>\r\n              <hr />\r\n            </>\r\n          ) : null}\r\n\r\n          <h2>Grupy</h2>\r\n          <ul className=\"list\">\r\n            {groupsLis.length ? groupsLis : \"Nie należysz do żadnej grupy\"}\r\n          </ul>\r\n        </nav>\r\n\r\n        <article className={`main_wrapper-splited-right_column ${className}`}>\r\n          {children}\r\n        </article>\r\n      </Layout>\r\n    </AuthorizedContent>\r\n  )\r\n}\r\n"],"sourceRoot":""}